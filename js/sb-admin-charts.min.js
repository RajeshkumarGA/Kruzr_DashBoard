// Chart.js scripts
// -- Set new default font family and font color to mimic Bootstrap's default styling
Chart.defaults.global.defaultFontFamily = '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = '#292b2c';
// -- Area Chart Example

var day = [];
var lineChartData =[];
var month = [];
var barChartData = [];
var j=0;
for (var i=7;i>0;i--){
  day[j]= new Date(new Date().setDate(new Date().getDate()-i));
  day[j]=day[j].getDate()+" "+ Month(day[j].getMonth()+1);
  j++;

}
var CurrentDate = new Date();
var CurrentMonth = CurrentDate.getMonth()+1;
for(var i=0;i<6;i++){
  month.push(Month(CurrentMonth-i));
}
////console.log(month);


function Month(getValue){
  switch(getValue){
    case 1 :
    return 'Jan';
    break;
    case 2 :
    return 'Feb';
    break;
    case 3 :
    return 'Mar';
    break;
    case 4 :
    return 'Apr';
    break;
    case 5 :
    return 'May';
    break;
    case 6 :
    return 'Jun';
    break;
    case 7 :
    return 'Jul';
    break;
    case 8 :
    return 'Aug';
    break;
    case 9 :
    return 'Sep';
    break;
    case 10 :
    return 'Oct';
    break;
    case 11 :
    return 'Nov';
    break;
    case 12 :
    return 'Dec';
    break;
  }

}
getDataPerDay();
getDataPerMonth();
function getDataPerDay(){
  $.ajax({
    url:'linecharts.php',
    dataType:'json',
    type: 'post',
    data: {},
    success:function(response){
      for(var i=0;i<response.data.length;i++){
        lineChartData.push(response.data[i].downloadsCountPerDay);
        //console.log(response.data[i]);
      }
      renderLineGraph(day,lineChartData);
    },
    error:function(exception){console.log('Exception:'+exception);}
  });
};

function getDataPerMonth(){
  $.ajax({
    url:'barcharts.php',
    dataType:'json',
    type: 'post',
    data: {},
    success:function(response){
      for(var i=response.data.length-1;i>=0;i--){
        barChartData.push(response.data[i].downloadsCountPerMonth);
        //console.log(response.data[i]);
        //barChartData.reverse();
      }
      renderBarGraph(month,barChartData);
    },
    error:function(exception){console.log('Exception:'+exception);}
  });
};

//var weekArray = [new Date().setDate(new Date().getDate()-5),),new Date(new Date().setDate(new Date().getDate()-3)),new Date(new Date().setDate(new Date().getDate()-2)),new Date(new Date().setDate(new Date().getDate()-1))]
function renderLineGraph(getDataX,getDataY){
  var ctx = document.getElementById("myAreaChart");
  var myLineChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: getDataX,
      datasets: [{
        label: "Downloads",
        lineTension: 0.3,
        backgroundColor: "rgba(2,117,216,0.2)",
        borderColor: "rgba(2,117,216,1)",
        pointRadius: 5,
        pointBackgroundColor: "rgba(2,117,216,1)",
        pointBorderColor: "rgba(255,255,255,0.8)",
        pointHoverRadius: 5,
        pointHoverBackgroundColor: "rgba(2,117,216,1)",
        pointHitRadius: 20,
        pointBorderWidth: 2,
        data:getDataY,
      }],
    },
    options: {
      responsive:true,
      scales: {
        xAxes: [{
          time: {
            unit: 'date'
          },
          gridLines: {
            display: false
          },
          ticks: {
            maxTicksLimit: 7
          }
        }],
        yAxes: [{
          ticks: {
            min: 0,
            max: 500,
            maxTicksLimit: 5
          },
          gridLines: {
            color: "rgba(0, 0, 0, .125)",
          }
        }],
      },
      legend: {
        display: false
      }
    }
  });
}
// -- Bar Chart Example
function renderBarGraph(getX,getY){
  var ctx = document.getElementById("myBarChart");
  var myLineChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: getX,
      datasets: [{
        label: "Downloads",
        backgroundColor: "rgba(2,117,216,1)",
        borderColor: "rgba(2,117,216,1)",
        data:getY,
      }],
    },
    options: {
      scales: {
        xAxes: [{
          time: {
            unit: 'Dates'
          },
          gridLines: {
            display: false
          },
          ticks: {
            maxTicksLimit: 7
          }
        }],
        yAxes: [{
          ticks: {
            min: 0,
            max: 500,
            maxTicksLimit: 5
          },
          gridLines: {
            display: true
          }
        }],
      },
      legend: {
        display: false
      }
    }
  });
}
// -- Pie Chart Example
var ctx = document.getElementById("myPieChart");
var myPieChart = new Chart(ctx, {
  type: 'pie',
  data: {
    labels: ["Blue", "Red", "Yellow", "Green"],
    datasets: [{
      data: [12.21, 15.58, 11.25, 8.32],
      backgroundColor: ['#007bff', '#dc3545', '#ffc107', '#28a745'],
    }],
  },
});
